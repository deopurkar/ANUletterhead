\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ANUletterhead}[2021/10/15 ANU Letterhead]

\DeclareOption{sans}{
  \renewcommand{\familydefault}{\sfdefault}
}

\DeclareOption{roman}{
  \renewcommand{\familydefault}{\rmdefault}
}

\newcommand{\@personalinfo}{
  Anand Deopurkar\\
  Senior Lecturer \medskip \\
  Mathematical Sciences Institute \medskip\\
  +61 2 6125 4628 \\
  \texttt{anand.deopurkar@anu.edu.au} \medskip\\
  \today
}
\newcommand{\@personalwidth}{5cm}
\newcommand{\personalinfo}[2]{
  \renewcommand{\@personalinfo}{#1}
  \renewcommand{\@personalwidth}{#2}
}

\newcommand{\@buildinginfo}{
  Hanna Neumann Building
}

\newcommand{\buildinginfo}[1]{
  \renewcommand{\@buildinginfo}{#1}
}

\ExecuteOptions{sans}

\ProcessOptions \relax
  
\RequirePackage{graphicx}
\RequirePackage[nocheck]{fancyhdr}
\RequirePackage{tikz}
\RequirePackage{helvet}
\RequirePackage{xcolor}
\RequirePackage{background}
\RequirePackage[includeheadfoot]{geometry}
\RequirePackage{calc}

\geometry{lmargin=3.25cm, rmargin=2.5cm, tmargin=0cm, bmargin=1cm, headheight=4cm, footskip=2cm}

\definecolor{ANUgold}{HTML}{BE830E}
\backgroundsetup{
  pages=all,
  angle=270,
  color=ANUgold,
  opacity=1,
  scale=1,
  vshift=-0.5*\paperwidth+2cm,
  contents=\rule{\paperheight}{1pt}
}

\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{plain}{
  \fancyfoot[RL, LO]{The Australian National University}
  \fancyfoot[C]{}
  \fancyfoot[RO, LE]{\thepage}
}

\fancypagestyle{firstpagestyle}{
  \fancyfoot[L]{\fontsize{10pt}{12pt}\selectfont \@buildinginfo\\The Australian National University}
  \fancyfoot[C]{\fontsize{10pt}{12pt}\selectfont Canberra 2600, ACT, Australia\\CRICOS Provider No. 00120C}
  \fancyheadoffset[L]{1.90cm}
  \fancyhead[L]{
    \begin{tikzpicture}
      \node[fill=white, inner ysep=3mm, inner xsep=0mm]
      {\includegraphics[height=1.6cm]{ANU_logo.png}};
    \end{tikzpicture}
    \vfill
  }
  \fancyhead[R]{
    \begin{minipage}[b]{\@personalwidth}
      \fontsize{10pt}{12pt}\selectfont
      \@personalinfo
      \vfill
    \end{minipage}
  }
}

\AtBeginDocument{
  \thispagestyle{firstpagestyle}
  \addtolength{\textheight}{3cm}%
  \afterpage{
    \global\advance\headheight by -3cm
  }
}

\endinput
